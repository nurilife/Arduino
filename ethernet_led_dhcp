#include<EtherCard.h>
staticbytemymac[]={0x74,0x69,0x69,0x2D,0x30,0x31};
staticbytemyip[]={0,0,0,0};//0.0.0.0으로설정
intledPin10=9;
byteEthernet::buffer[700];
charconstpage[]PROGMEM=
  "HTTP/1.0503ServiceUnavailable\r\n"
  "Content-Type:text/html\r\n"
  "Retry-After:600\r\n"
  "\r\n"
  "<html>"
  "<head><title>"
  "ServiceTemporarilyUnavailable"
  "</title></head>"
  "<body>"
  "<h3>Thispageisusedbehindthescene</h3>"
  "<p><em>"
  "CommandstocontrolLEDaretransferredtoArduino.<br/>"
  "Thesyntax:http://192.168.0.XX/?LED10=OFForON"
  "</em></p>"
  "</body>"
  "</html>";
voidsetup()
{
  pinMode(ledPin10,OUTPUT);
  Serial.begin(9600);
  Serial.println("TryingtogetanIP...");
  Serial.print("MAC:");
  for(bytei=0;i<6;++i)
  {
    Serial.print(mymac[i],HEX);
    if(i<5)
      Serial.print(':');
  }
  Serial.println();
  if(ether.begin(sizeofEthernet::buffer,mymac)==0)
  {
    Serial.println("FailedtoaccessEthernetcontroller");
  }
  else
  {
    Serial.println("Ethernetcontrolleraccess:OK");
  }
  Serial.println("SettingupDHCP");
  if(!ether.dhcpSetup())
  {
    Serial.println("DHCPfailed");
    //HandleDHCPfailureasneeded
    //blinkLed();//blinkforevertoindicateaproblem
  }
  ether.printIp("MyIP:",ether.myip);
  ether.printIp("Netmask:",ether.netmask);
  ether.printIp("GWIP:",ether.gwip);
  ether.printIp("DNSIP:",ether.dnsip);
}
voidloop()
{
  wordlen=ether.packetReceive();
  wordpos=ether.packetLoop(len);
  //IFLED10=ONturnitON
  if(strstr((char*)Ethernet::buffer+pos,"GET/?LED10=ON")!=0)
  {
    Serial.println("ReceivedONcommand");
    digitalWrite(ledPin10,HIGH);
  }
  //IFLED10=OFFturnitOFF
  if(strstr((char*)Ethernet::buffer+pos,"GET/?LED10=OFF")!=0)
  {
    Serial.println("ReceivedOFFcommand");
    digitalWrite(ledPin10,LOW);
  }
  //showsomedatatotheuser
  memcpy_P(ether.tcpOffset(),page,sizeofpage);
  ether.httpServerReply(sizeofpage-1);
}
